<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Bahyway.ShoWay.UI.ViewModels"
        xmlns:controls="using:Bahyway.ShoWay.UI.Controls"
        xmlns:monitor="using:Bahyway.ShoWay.UI.Views.Monitoring"
        x:Class="Bahyway.ShoWay.UI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Ontoway Professional - Akkadian v3.1"
        Width="1400" Height="800"
        Background="#1e1e1e">

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<!-- NEW: Top Level Tab Control -->
	<TabControl Margin="5">

		<!-- TAB 1: YOUR EXISTING EDITOR -->
		<TabItem Header="Ontology Designer" FontSize="16" FontWeight="Bold">

			<!-- THIS IS YOUR ORIGINAL GRID CODE -->
			<Grid ColumnDefinitions="250, *, 250" RowDefinitions="*, 150">

				<!-- LEFT: TOOLBOX -->
				<Border Grid.Column="0" Background="#252526" BorderBrush="#3F3F46" BorderThickness="0,0,2,0">
					<ScrollViewer>
						<StackPanel Spacing="15" Margin="15">
							<TextBlock Text="AKKADIAN ENGINE" FontWeight="Bold" Foreground="#3498db" FontSize="14"/>
							<Separator Background="#3F3F46" Height="2"/>
							<Button Command="{Binding BuildAndDeployCommand}" Background="#27ae60" Foreground="White" HorizontalAlignment="Stretch" Padding="10" CornerRadius="4">
								<StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
									<TextBlock Text="🚀"/>
									<TextBlock Text="GENERATE ECOSYSTEM" FontWeight="Bold"/>
								</StackPanel>
							</Button>
							<Separator Background="#3F3F46" Height="2" Margin="0,10"/>
							<TextBlock Text="TEMPLATES" FontWeight="Bold" Foreground="#cccccc"/>
							<ComboBox Name="TemplateSelector" SelectionChanged="OnTemplateChanged" HorizontalAlignment="Stretch">
								<ComboBoxItem Content="Cytoscape Standard" Tag="Cytoscape_Standard" IsSelected="True"/>
								<ComboBoxItem Content="Three.js 3D" Tag="ThreeJS_3D"/>
								<ComboBoxItem Content="D3.js Force" Tag="D3_Force"/>
							</ComboBox>
							<Button Name="ShowTemplatesBtn" Click="ShowTemplateGallery" Background="#34495e" Foreground="White" Padding="10,8" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" CornerRadius="4">
								<StackPanel Orientation="Horizontal" Spacing="8">
									<TextBlock Text="📊"/>
									<TextBlock Text="Gallery" FontWeight="SemiBold"/>
								</StackPanel>
							</Button>
							<Separator Background="#3F3F46" Height="2" Margin="0,10"/>
							<TextBlock Text="TOOLBOX" FontWeight="Bold" Foreground="#cccccc"/>
							<StackPanel Spacing="10">
								<StackPanel Spacing="5" Background="Transparent" PointerPressed="OnToolPointerPressed" Tag="Hub_Customer">
									<Border Width="50" Height="30" Background="#3498db" CornerRadius="2"/>
									<TextBlock Text="Hub: Customer" Foreground="Gray" HorizontalAlignment="Center" FontSize="10"/>
								</StackPanel>
								<StackPanel Spacing="5" Background="Transparent" PointerPressed="OnToolPointerPressed" Tag="Sat_Details">
									<Ellipse Width="40" Height="40" Fill="#f1c40f"/>
									<TextBlock Text="Sat: Details" Foreground="Gray" HorizontalAlignment="Center" FontSize="10"/>
								</StackPanel>
							</StackPanel>
						</StackPanel>
					</ScrollViewer>
				</Border>

				<!-- CENTER: NATIVE CANVAS -->
				<controls:GraphCanvas Name="NativeCanvas" Width="50000" Height="50000" Grid.Column="1"/>

				<!-- RIGHT: PROPERTIES -->
				<Border Grid.Column="2" Background="#252526" BorderBrush="#3F3F46" BorderThickness="2,0,0,0">
					<StackPanel Margin="15" Spacing="10">
						<TextBlock Text="PROPERTIES" FontWeight="Bold" Foreground="#cccccc"/>
						<Separator Background="#3F3F46" Height="2"/>
						<StackPanel IsVisible="{Binding SelectedNode, Converter={x:Static ObjectConverters.IsNotNull}}">
							<TextBlock Text="Name" Foreground="Gray"/>
							<TextBox Text="{Binding SelectedNode.Label}" Background="#333" Foreground="White" BorderThickness="0"/>
							<TextBlock Text="ID" Foreground="Gray" Margin="0,10,0,0"/>
							<TextBox Text="{Binding SelectedNode.Id}" IsReadOnly="True" Background="#222" Foreground="Gray" BorderThickness="0"/>
							<TextBlock Text="X Position" Foreground="Gray" Margin="0,10,0,0"/>
							<TextBox Text="{Binding SelectedNode.X}" Background="#333" Foreground="White" BorderThickness="0"/>
							<TextBlock Text="Y Position" Foreground="Gray" Margin="0,10,0,0"/>
							<TextBox Text="{Binding SelectedNode.Y}" Background="#333" Foreground="White" BorderThickness="0"/>
						</StackPanel>
						<TextBlock Text="Select a node to edit" Foreground="Gray" IsVisible="{Binding SelectedNode, Converter={x:Static ObjectConverters.IsNull}}"/>
					</StackPanel>
				</Border>

				<!-- BOTTOM: CONSOLE -->
				<Grid Grid.Row="1" Grid.ColumnSpan="3" RowDefinitions="Auto, *">
					<Border Grid.Row="0" Background="#2d2d2d" Padding="10,5" BorderBrush="#3F3F46" BorderThickness="0,1,0,0">
						<Grid ColumnDefinitions="Auto, *, Auto">
							<StackPanel Orientation="Horizontal" Spacing="15" Grid.Column="0">
								<TextBlock Text="🌍 SPATIAL SECTOR:" Foreground="Gray" VerticalAlignment="Center"/>
								<TextBlock Name="TxtSpatialID" Text="0x00000000" Foreground="#00FF00" FontFamily="Consolas" FontWeight="Bold" VerticalAlignment="Center"/>
								<TextBlock Name="TxtCoordinates" Text="(0, 0)" Foreground="#cccccc" FontFamily="Consolas" VerticalAlignment="Center"/>
							</StackPanel>
							<StackPanel Orientation="Horizontal" Spacing="10" Grid.Column="2">
								<TextBlock Text="Nodes in View:" Foreground="Gray" VerticalAlignment="Center"/>
								<TextBlock Name="TxtNodeCount" Text="0 / 1,000,000,000" Foreground="#3498db" FontWeight="Bold" VerticalAlignment="Center"/>
							</StackPanel>
						</Grid>
					</Border>
					<Border Grid.Row="1" Background="#000000">
						<ScrollViewer>
							<TextBlock Text="{Binding ConsoleLog}" Foreground="#00FF00" FontFamily="Consolas" Margin="10" TextWrapping="Wrap"/>
						</ScrollViewer>
					</Border>
				</Grid>
			</Grid>
		</TabItem>

		<!-- TAB 2: THE NEW CONTROL ROOM -->
		<TabItem Header="Pipeline Monitor" FontSize="16" FontWeight="Bold">
			<!-- We give this a Name so we can set its DataContext in code-behind -->
			<monitor:PipelineMonitorView Name="MonitorView" />
		</TabItem>

	</TabControl>
</Window>